
<style>
    .page-title{
        background-color:lightgray;
    }
    .page-title h4{
        text-align:center;
    }
    label{
         float:left;
     }

    table {
        border-collapse: collapse;
        border-spacing: 0;
        width: 100%;
        border: 1px solid #ddd;
    }

    th, td {
        text-align: left;
        padding: 8px;
    }

    tr:nth-child(even){
        background-color: #f2f2f2
    }
    

    p{
        margin-bottom:0px;
    }


</style>




<div class="container">
    <div class="col-md-12 page-title">
        <h4>Raw Mat'l Report</h4>    
    </div><br>
   
    <div class="col-md-6 offset-md-3" style="background-color:#ff6600; color:white; border-radius:10px;">
        <div class="form-inline">
            <p style="margin-right:30px; margin-left:40px; margin-bottom:0px;">Speed time : </p>
            <p id="ST_Day" style="margin-right:20px; margin-bottom:0px;">0</p>
            <p style="margin-right:20px; margin-bottom:0px;">Day(s)</p>
            <p id="ST_Hour" style="margin-right:20px; margin-bottom:0px;">0</p>
            <p style="margin-right:20px; margin-bottom:0px;">Hour(s)</p>
            <p id="ST_Minute" style="margin-right:20px; margin-bottom:0px;">0</p>
            <p style="margin-bottom:0px;">Minute(s)</p>
        </div>
    </div><br>

    <div class="row">
        <div class="col-md-6">
            <h4>Operator</h4>
            <div id="Part_Operator" class="col-md-12" style="border-style:solid; border-width:1px; border-color:gray; border-radius:10px;">
                <div class="row">
                    <div class="col-md-6">
                        <p style="margin-bottom:0px;">Grade</p>
                        <select id="GradeName" onchange="SetPropertiesInfo('GetAll');" class="form-control form-control-sm" style="width:100%;">
                            <option value="0">Please select...</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <p style="margin-bottom:0px;">Resource No.</p>
                        <input id="ResourceNo" type="text" class="form-control form-control-sm col-md-12" placeholder="">
                    </div>
                </div>
                <br>
                <div class="row">
                    <div class="col-md-6">
                        <p style="margin-bottom:0px;">Color</p>
                        <select id="Color" class="form-control form-control-sm" style="width:100%;" readonly>
                            <option value="0">Please select...</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <p style="margin-bottom:0px;">Package (Kg)</p>
                        <select id="Package" class="form-control form-control-sm" style="width:100%;" readonly>
                            <option value="0">Please select...</option>
                        </select>
                    </div>
                </div>
                <br>
                
                <div class="row">
                    <div class="col-md-6">
                        <p style="margin-bottom:0px;">Lot No.</p>
                        <input id="LotNo" type="text" class="form-control form-control-sm col-md-12" placeholder="" autocomplete="off">
                    </div>
                    <div class="col-md-6">
                        <p style="margin-bottom:0px;">Lot Size (Ton)</p>
                        <input id="LotSize" type="text" class="form-control form-control-sm col-md-12" placeholder="" autocomplete="off">
                    </div>
                </div><br>
                <div class="row">
                    <div class="col-md-6">
                        <div id="" class="form-inline" style="margin-top:25px; margin-left:20px;">
                            <div class="form-check" style="margin-right:10px; margin-left:10px;">
                                <label class="form-check-label">
                                    <input type="radio" class="form-check-input" name="TestMethod" value="Trial">Trial
                                </label>
                            </div>
                            <div class="form-check">
                                <label class="form-check-label">
                                    <input type="radio" class="form-check-input" name="TestMethod" value="Commercial">Commercial
                                </label>
                            </div>  
                        </div>
                    </div>
                    <div class="col-md-6">
                        <p style="margin-bottom:0px;">Type</p>
                        <select id="TypeName" class="form-control form-control-sm" style="width:100%;">
                            <option value="0">Please select...</option>
                        </select>
                    </div>      
                </div><br> 
                <br>
            </div><br>


            <h4>Date</h4>
            <div id="Part_Date" class="col-md-12" style="border-style:solid; border-width:1px; border-color:gray; border-radius:10px;">
                <div class="row">
                    <div class="col-md-6">
                        <p style="margin-bottom:0px;">Test date</p>
                        <input id="TestDate" type="text" class="form-control form-control-sm col-md-12" placeholder="" readonly autocomplete="off">
                    </div>
                    <div class="col-md-6">
                        <p style="margin-bottom:0px;">Report date</p><p style="color:red; position:absolute;right:20px; top:0px;">*</p>
                        <input id="ReportDate" onclick="SetTimeToInput('ReportDate');" onchange="CalSpeedTime();" type="text" class="form-control form-control-sm col-md-12" placeholder="" autocomplete="off">
                    </div>
                    <div class="col-md-6">
                        <p style="margin-bottom:0px;">Recieved COA date</p>
                        <input id="RecievedCOADate" type="text" class="DatePicker form-control form-control-sm col-md-12" placeholder="" autocomplete="off">
                    </div>
                    <div class="col-md-6">
                        <p style="margin-bottom:0px;">Report by</p>
                        <input id="ReportBy" title="" type="text" class="form-control form-control-sm col-md-12" placeholder="" readonly>
                    </div><br><br><br><br>
                </div>   
            </div>

        </div>
        <div class="col-md-6">
            <h4>Engineer</h4>
            <div id="Part_Engineer" class="col-md-12" style="border-style:solid; border-width:1px; border-color:gray; border-radius:10px;">
                <div class="row" style="padding-top:10px;">
                    <div class="col-md-6">
                        <p style="margin-bottom:0px;">Approved by</p>
                        <input id="ApprovedBy" type="text" class="form-control form-control-sm col-md-12" placeholder="" readonly>
                    </div>
                    <div class="col-md-6">
                        <p style="margin-bottom:0px;">Approved date</p>
                        <input id="ApprovedDate" type="text" class="form-control form-control-sm col-md-12" placeholder="" readonly autocomplete="off">
                    </div><br><br><br><br>
                </div><br>

                <div class="row">
                    <div class="col-md-2 offset-md-2">
                        <p style="margin-bottom:0px;">Class</p>
                    </div>
                    <div class="col-md-6">
                        <select id="Class" class="form-control form-control-sm" style="width:100%;">
                            <option value="-">Please select...</option>
                            <option value="Incomplete Testing">Incomplete Testing</option>
                            <option value="Waiting for Approval">Waiting for Approval</option>
                            <option value="Pass">Pass</option>
                            <option value="Unclass">Unclass</option>
                            <option value="Off">Off</option>
                            <option value="Delete">Delete</option>
                            <option value="Pending">Pending</option>
                        </select>
                    </div>
                </div><br>
            </div><br>
            <h4 style="color:red;">Note</h4>
            <div class="col-md-12" style="border-style:solid; border-width:2px; border-color:lightgray;">
                <p id="Note" style="color:red;"></p>
            </div>
        </div>
    </div>
    <br><br>
    <div class="col-md-4 offset-md-4">

        <button id="Btn_ShowData" onclick="ShowPropertiesData('Create');" type="button" class="btn btn-primary btn-sm" style="background-color:#1BA1E2; border-color:#1BA1E2;">Show Data (Rank A)</button>
        <button id="Btn_ClearData" onclick="ShowPropertiesData('Clear');" type="button" class="btn btn-primary btn-sm" style="background-color:#1BA1E2; border-color:#1BA1E2;">Clear Data</button>
        <br>
    </div>
    

    <h4>Properties</h4>
    <div style="width:100%; height:2px; background-color:lightgray;"></div>
    <div class="col-md-12" style="padding-top:20px;">
        <table class="table">
            <thead style="background-color:#007bff; color:white; border-color:#007bff;">
                <tr>
                    <th style="min-width:200px;"scope="col"><p style="margin-bottom:0px;">Properties</p></th>
                    <th style="min-width:100px;" scope="col"><p style="margin-bottom:0px;">Unit</p></th>
                    <th style="width:200px;" scope="col"><p style="margin-bottom:0px;">Criteria (min-max)</p></th>
                    <th style="width:100px;" scope="col"><p style="margin-bottom:0px;">Input</p></th>
                    <th style="width:100px;" scope="col"><p style="margin-bottom:0px;">Output</p></th>
                    <th style="width:100px;" scope="col"><p style="margin-bottom:0px;">Result</p></th>
                    <th scope="col"><p style="margin-bottom:0px;">Test Method</p></th>
                </tr>
            </thead>
            <tbody id="TablePQR">
                <!--<tr style="border-style:solid; border-width:1px; border-color:lightgray;">
                <th scope="row">Properties</th>
                <td class="text-tr">Mark</td>
                <td class="text-tr"><input id="" type="text" class="form-control form-control-sm" placeholder=""></td>
                <td class="text-tr"><input id="" type="text" class="form-control form-control-sm" placeholder=""></td>
                <td class="text-tr"><input id="" type="text" class="form-control form-control-sm" placeholder=""></td>
                <td class="text-tr"><input id="" type="text" class="form-control form-control-sm" placeholder=""></td>
                <td class="text-tr"><input id="" type="text" class="form-control form-control-sm" placeholder=""></td>
                <td class="text-tr">@mdo</td>
                </tr>-->
            </tbody>
        </table>   

            <button id="TestResult" onclick="GetTestResult();" disabled="disabled" type="button" class="btn btn-primary btn-sm pull-right" style="background-color:#1BA1E2; border-color:#1BA1E2;">Test Result</button>
    </div>
    <br><br>


    
    <div style="position:fixed; right:5%; top:20%; width:13px;">
        <a id="CloseForm2" data-toggle="tooltip" title="Close Form" type="button" class="btn btn btn-primary btn-md" style="background-color:rgb(138, 28, 28); border-color:rgb(138, 28, 28); color:white; font-weight:bold;"><i class="fa fa-remove"></i></a>
        <!--<a onclick="Attachfile();" data-toggle="tooltip" title="Attachfile" type="button" class="btn btn btn-primary btn-md" style="background-color:#1BA1E2; border-color:#1BA1E2; color:white; font-weight:bold;"><i class="fa fa-paperclip"></i></a>-->
        <a onclick="SaveDraft();" id="btnSaveDraft" data-toggle="tooltip" title="Save Draft" type="button" class="btn btn btn-primary btn-md" style="background-color:rgb(196, 193, 50); border-color:rgb(196, 193, 50);; color:white; font-weight:bold;"><i class="fa fa-floppy-o"></i></a>
    </div>
</div>



<script type="text/javascript">


    // Declare global variable
    var FormID = GetParameterByName('FormID');
    var LinkView = '<a tartget="_blank" href="https://scgchemicals.scg.com/lotusnotes/GSC_RawMatLab/SitePages/Raw%20Material%20Report.aspx?FormMaster=1&FormID='+FormID+'">View</a>'
    var FormType = 'FormView';
    var ListData = 'Raw Material Report'; // listname store for current item
    var SummaryPage = SiteUrl + '/Lists/Raw%20Material%20Report';
    var workflow =  {
            name:'RawMaterialReport',
            version:'2013'
    };
    var Properties = [];


    //TypeDom Following => text,textarea,date,label,select[people],people,check,var,radio,object
    //TypeCol following => singleline,multipleline,date,people,radio
    var TempCurrentData = {
        field1:{
                ID:'ST_Day',    
                Title:'Speed time day',
                TypeDom:'label',   
                TypeCol:'singleline',  
                Data:null,  
                Col:'SpeedTime_Day'
            },
        field2:{
                ID:'ST_Hour',    
                Title:'Speed time hour',
                TypeDom:'label',   
                TypeCol:'singleline',  
                Data:null,  
                Col:'SpeedTime_Hour'
            },
        field3:{
                ID:'ST_Minute',    
                Title:'Speed time minute',
                TypeDom:'label',   
                TypeCol:'singleline',  
                Data:null,  
                Col:'SpeedTime_Minute'
            },
        field4:{
                ID:'GradeName',    
                Title:'Grade',
                TypeDom:'select',   
                TypeCol:'singleline',  
                Data:null,  
                Col:'Grade'
            },
        field5:{
                ID:'ResourceNo',    
                Title:'ResourceNo',
                TypeDom:'text',   
                TypeCol:'singleline',  
                Data:null,  
                Col:'ResourceNo'
            },
        field6:{
                ID:'Color',    
                Title:'Color',
                TypeDom:'select',   
                TypeCol:'singleline',  
                Data:null,  
                Col:'Color'
            },
        field7:{
                ID:'Package',    
                Title:'Package',
                TypeDom:'select',   
                TypeCol:'singleline',  
                Data:null,  
                Col:'Package'
            },
        field8:{
                ID:'LotNo',    
                Title:'LotNo',
                TypeDom:'text',   
                TypeCol:'singleline',  
                Data:null,  
                Col:'LotNo'
            },
        field9:{
                ID:'LotSize',    
                Title:'LotSize',
                TypeDom:'text',   
                TypeCol:'singleline',  
                Data:null,  
                Col:'LotSize'
            },
        field10:{
                ID:'TestDate',    
                Title:'TestDate',
                TypeDom:'date',   
                TypeCol:'singleline',  
                Data:null,  
                Col:'TestDate'
            },
        field11:{
                ID:'ReportDate',    
                Title:'ReportDate',
                TypeDom:'date',   
                TypeCol:'singleline',  
                Data:null,  
                Col:'ReportDate'
            },
        field12:{
                ID:'RecievedCOADate',    
                Title:'Recieved COA Date',
                TypeDom:'date',   
                TypeCol:'singleline',  
                Data:null,  
                Col:'RecievedCOADate'
            },
        field13:{
                ID:'ReportBy',    
                Title:'ReportBy',
                TypeDom:'people',   
                TypeCol:'people',  
                Data:null,  
                Col:'ReportBy'
            },
        field14:{
                ID:'TestMethod',    
                Title:'TestMethod',
                TypeDom:'radio',   
                TypeCol:'radio',  
                Data:null,  
                Col:'RawMaterialType'
            },
        field15:{
                ID:'ApprovedBy',    
                Title:'ApprovedBy',
                TypeDom:'people',   
                TypeCol:'people',  
                Data:null,  
                Col:'ApprovedBy'
            },
        field16:{
                ID:'ApprovedDate',    
                Title:'ApprovedDate',
                TypeDom:'text',   
                TypeCol:'singleline',  
                Data:null,  
                Col:'ApprovedDate'
            },
        field17:{
                ID:'Class',    
                Title:'Class',
                TypeDom:'select',   
                TypeCol:'singleline',  
                Data:null,  
                Col:'Class'
            },
        field18:{
                ID:'TypeName',    
                Title:'Type',
                TypeDom:'select',   
                TypeCol:'singleline',  
                Data:null,  
                Col:'TypeName'
            },
        field19:{
                ID:'Year',    
                Title:'Year',
                TypeDom:'var',   
                TypeCol:'singleline',  
                Data:GetCurrentYear(),  
                Col:'Year'
            },
    };
    
    /////////////////////////////////////

    // Place For trigger from DOM 
    $('#CloseForm , #CloseForm2').click(function(){
        CloseForm(0,SummaryPage); 

    });

    $('#AddPQR').click(function(){
        AddPQR();
    });

 
    function SetTimeToInput(id){
           
            var time = GetCurrentTime();
            $('#'+id).val(time);
            CalSpeedTime();
    }
            
        
 



    $( "input" ).change(function() {
        
            var str = $(this).val();
            if (str.indexOf(';') > -1 || str.indexOf('[') > -1 || str.indexOf(']') > -1 || str.indexOf('|') > -1)
            {
                $(this).css("background-color","red");
                $(this).css("color","white");
                alert('Don\'t input "; [ ] |" ');  
            }
            else{
                $(this).css("color","black");
                $(this).css("background-color","white");
                
            }

    });
    

    $('input').keypress(function(event){
        var keycode = (event.keyCode ? event.keyCode : event.which);
        if(keycode == '13'){
            event.preventDefault();
            return false;
        }
    });

    /*$('#ReportDate').timepicker({
        timeFormat: "HH:mm"
    });*/

    

    ///////////////////////////////
    

    // Set inittial form  
    // such as option in select , default date, default current user , default text and label
    function SetInitialForm(){
      
        $('.Attachfile').hide();
        
        $('#ReportBy').val(CurrentUser.Name);
        $('#ReportBy').attr('title',CurrentUser.ID);
        

        // Get Grade name
        var query = '?$select=GradeName&$top=5000&$filter=FormStatus eq \'Approve\'&$orderby=GradeName asc';
        var data = GetItemByRestAPI(Disp_InputMaster,query);
        if(data){
            var str='<option value="-">Please Select...</option>';
            for(i=0;i<data.length;i++){
                str+='<option value="'+data[i].GradeName+'">'+data[i].GradeName+'</option>';
            }
            $('#GradeName').empty();
            $('#GradeName').append(str);
        }
        //////////////////////////

        // Get Color 
        var query = '?$select=Color&$top=5000&$orderby=Color asc';
        var data = GetItemByRestAPI(Disp_Master_Color,query);
        if(data){
            var str='<option value="-">Please Select...</option>';
            for(i=0;i<data.length;i++){
                str+='<option value="'+data[i].Color+'">'+data[i].Color+'</option>';
            }
            $('#Color').empty();
            $('#Color').append(str);
        }
        //////////////////////////

        // Get Package 
        var query = '?$select=Package&$top=5000&$orderby=Package asc';
        var data = GetItemByRestAPI(Disp_Master_Package,query);
        if(data){
            var str='<option value="-">Please Select...</option>';
            for(i=0;i<data.length;i++){
                str+='<option value="'+data[i].Package+'">'+data[i].Package+'</option>';
            }
            $('#Package').empty();
            $('#Package').append(str);
        }
        //////////////////////////


        // Get TypeName 
        var query = '?$select=InputType&$top=5000&$orderby=InputType asc';
        var data = GetItemByRestAPI(Disp_Master_Type,query);
        if(data){
            var str='<option value="-">Please Select...</option>';
            for(i=0;i<data.length;i++){
                str+='<option value="'+data[i].InputType+'">'+data[i].InputType+'</option>';
            }
            $('#TypeName').empty();
            $('#TypeName').append(str);
        }
        //////////////////////////
        
    }

    // Get Data when user click view an item. this will be called by FormView();
    // if user click new item this function will not be called
    function GetData(){ // FormMethodTemplate
  
        var query = '?$select=*,ReportBy/Id,ReportBy/Title,Author/Title,Author/Id,ApprovedBy/Id,ApprovedBy/Title&$expand=ReportBy,Author,ApprovedBy&$filter=FormID eq \''+FormID+'\'';
        var data = GetItemByRestAPI(Disp_RawMatReport,query);
        
        if(data){
            if(data.length > 0){
 
                data = data[0];
                
                var name = data[workflow.name];
                
                CheckStatusWorkflow(name , workflow.version);  // FormMethodTemplate
                
                for(var i in TempCurrentData){
                
                        var item = TempCurrentData[i];
                        var TempData = data[item.Col];
                       
                        // Get and set data in element by item data
                        SetElementByItemData(item,TempData);
                    
                        

                    
                }
            }
            else{

                RoutingPage('PageItemNotFound.html'); // FormMethodTemplate
            }
            return data;
        }


    }

    // Form display when user click new form .
    // what you do want to display or change element new form.
    // input action to this function
    function FormNew(){
        // set panel status 
        $('#DocNO').text('-');
        $('#CreateDate').text(SetDateTime()); 
        $('#FormStatus').text('Create');
        $('#Permission').text('Requestor');
        SetFormAction(); // FormMethodTemplate

        var time = GetCurrentTime();
        $('#TestDate').val(time);
        //$("#TestDate").datepicker().datepicker("setDate", new Date());
        $('#Part_Engineer *').attr('disabled','disabled');
        $('#Part_Engineer').css('background-color','lightgray');

        $('#ST_Day ,#ST_Hour ,#ST_Minute').text('0');

        // check permission creator
        var query = '?$select=User/Title,User/Id&$expand=User&$filter=User/Title eq \''+CurrentUser.Name+'\' and UserLevel eq \'Creator\'';
        var data = GetItemByRestAPI(Disp_Master_Approval,query);
        debugger;
        if(data){
           
            if(data.length == 0){
                alert('You have no permission to create this form.');
                
                $('body *').attr('readonly', true);
                    $('body *').css('cursor', 'no-drop');
                    $('body *').on('mousedown', function(e) {
                        e.preventDefault();
                        this.blur();
                        window.focus();
                    });
                
                $('#Approval').hide();
                $('#Permission').text('No Permission');
                $('#Approval ,#Btn_ShowData ,#Btn_ClearData ,#TestResult ,#btnSaveDraft').hide();

                // prevent click field test date
                $("#ReportDate ,#TestDate").removeAttr("onclick");


                
            }
         
        }



    }

    // Form display when user click view an item.
    // if user click new item this function will not be called.
    function FormView(){
        var data = GetData();
        RenderProp();
        SetPropertiesInfo('GetNote');
        
        if(data){


            Form.FormStatus = data.FormStatus;
            //$('#DocNO').text(data.RunningNO);
            $('#CreateDate').text(ConvertDate(data.Created)); 
            $('#FormStatus').text(data.FormStatus);
            SetFormAction(); // FormMethodTemplate


            if(Form.FormStatus == 'Create'){
                
                $('#Permission').text('Requestor');
                $('#Part_Engineer *').attr('disabled','disabled');
                $('#Part_Engineer').css('background-color','lightgray');
                
            }

            
            else if(Form.FormStatus == 'Waiting for Approval'){
                var permission = 'Visitor';
                var query = '?$select=User/Title,User/Id&$expand=User&$top=100&$filter=UserLevel eq \'Approver\' and User/Title eq \''+CurrentUser.Name+'\'&$orderby=User/Title asc';
                var data_permission = GetItemByRestAPI(Disp_Master_Approval,query);
                
                

                if(data_permission){
                    if(data_permission.length > 0){
                        permission = 'Approver'
                    }
                }
                          
                // prevent click field test date
                $("#ReportDate ,#TestDate").removeAttr("onclick");
                

                $('#Part_Operator *').attr('readonly','readonly');
                $('#Part_Operator').css('background-color','lightgray');
                $('#Part_Operator').on('mousedown', function(e) {
                    e.preventDefault();
                    this.blur();
                    window.focus();
                });

                
                $('#Part_Date *').attr('readonly','readonly');
                $('#Part_Date').css('background-color','lightgray');
                $('#Part_Date').on('mousedown', function(e) {
                    e.preventDefault();
                    this.blur();
                    window.focus();
                });


                if(permission == 'Approver'){
                    $('#Permission').text('Approver');
                    $('#ApprovedBy').val(CurrentUser.Name);
                    $('#ApprovedBy').attr('title',CurrentUser.ID);
                    $('#ApprovedDate').val(GetCurrentDate());
                    
                    $('#Btn_ShowData ,#Btn_ClearData ,#TestResult').hide();


                }
                else if(data.Author.Title == CurrentUser.Name){
                    $('#Permission').text('Requestor');
                    $('#Approval ,#Btn_ShowData ,#Btn_ClearData ,#TestResult ,#btnSaveDraft').hide();

                    $('#Part_Engineer *').attr('disabled','disabled');
                    $('#Part_Engineer').css('background-color','lightgray');

               
                    


                }
                else{
                    $('#Permission').text('Visitor');
                    $('#Approval').hide();
                    $('#Approval ,#Btn_ShowData ,#Btn_ClearData ,#TestResult ,#btnSaveDraft').hide();

                    $('#Part_Engineer *').attr('disabled','disabled');
                    $('#Part_Engineer').css('background-color','lightgray');

                    
                }
            }


            else if(Form.FormStatus == 'Reject'){
                
            
            }

            else if(Form.FormStatus == 'Complete'){
                

            }

            else{
                    $('body *').attr('readonly', true);
                    $('body *').css('cursor', 'no-drop');
                    $('body *').on('mousedown', function(e) {
                        e.preventDefault();
                        this.blur();
                        window.focus();
                    });
                
                $('#Approval').hide();
                $('#Permission').text('Visitor');
                $('#Approval ,#Btn_ShowData ,#Btn_ClearData ,#TestResult ,#btnSaveDraft').hide();

                // prevent click field test date
                $("#ReportDate ,#TestDate").removeAttr("onclick");
            }



        }

    }

    // when user click submit action will take action in this function      
    function SubmitAction(){ // FormMethodTemplate
        // manual validate 
        var ReportDate = $('#ReportDate').val();
        if(!ReportDate){
                alert('Please click 1 time on field Report date for generate data before press submit button.');
                return;
        }

        // disable submit button
        $('#SubmitAction').prop('disabled',true);


        var ActionTitle = $("#Approval_Select option:selected").text();
        Form.StatusAction = $('#Approval_Select').val();
        Form.FlagSubmit = true;
        if(Form.StatusAction != 0){
            $('#MainModal').modal('show');
            AddLoading();
            $('#TitleModal').text(ActionTitle);


            
            // Validate 
            var FlagValidatePass = ValidateData(); // FormMethodTemplate
            // enable submit button
            $('#SubmitAction').prop('disabled',false);
            if(FlagValidatePass == false){
                return;
            }

            
            



            // This function have method TypeDom Following text,textarea,date,label,select[people],people,check,var,radio,object
            TriggerTempData(); 
       

            var StatusCreate = CheckUpdateOrCreate(ListData); // FormMethodTemplate
          
            switch(StatusCreate){   // FormMethodTemplate
                case 'Create':
                    
                        
                            CreateListItem(ListData,TempCurrentData); // FormMethodTemplate
                       
                            //UpdatePQRToActive(); // 
                        
                        break;
                case 'Update':
                        
                            UpdateListItem(ListData,TempCurrentData); // FormMethodTemplate
                        
                        break;
            }
            
            //UpdateFlagAttachment(); // FormMethodTemplate
            HistoryLog('add'); // FormMethodTemplate

            var delayInMilliseconds = 1500; //1 second
            setTimeout(function() {
                CloseForm(1,SummaryPage); // FormMethodTemplate
            }, delayInMilliseconds);
        }
        else{
            alert('Please select any action..');
            
            // enable submit button
            $('#SubmitAction').prop('disabled',false);
        }

    }


// additional module function //////////////////////////////////////////////////////////////////////////////////////////////////////

    function TriggerTempData(){
        for(var i in TempCurrentData){
   
                    var field = TempCurrentData[i];
                
                        switch(field.TypeDom){
                            case 'text':
                                            field.Data = $('#'+field.ID).val();
                                            break;
                            case 'textarea':
                                            field.Data = $('#'+field.ID).val();
                                            break;
                            case 'date':
                                            var tempdata = $('#'+field.ID).val();

                                            if(tempdata){
                                                field.Data = $('#'+field.ID).val();
                                            }
                                            else{
                                                field.Data = '';
                                            }
                                            
                                        
                                            break;

                            case 'label':
                                            field.Data = $('#'+field.ID).text();
                                        
                                        
                                            break;
                            case 'select':
                                            
                                            if(field.TypeCol == 'people'){  // in case select query from people 
                                                if($('#'+field.ID).val() != '-'){
                                                    field.Data = {
                                                        //ID: $('#'+field.ID).val(),
                                                        ID: $('#'+field.ID + ' option').eq($('#'+field.ID).prop("selectedIndex")).val(),
                                                        Title: $('#'+field.ID+' option:selected').text()
                                                    }
                                                }
                                               
                                            }
                                            else{ // in case select query from normal text
                                                field.Data = $('#'+field.ID).val();
                                            }
                                            break;
                            case 'people':  
                                         
                                            field.Data = {
                                                ID: $('#'+field.ID).attr('title'),
                                                Title: $('#'+field.ID).val()
                                            }
                                            

                                            break;
                            case 'check':
                                            if ($('#'+field.ID).is(":checked"))
                                            {
                                                field.Data = true;
                                            }
                                            else{
                                                field.Data = false;
                                            }
                                            break;
                            case 'var':
                                            field.Data = field.Data;
                               
                                            break;
                            case 'radio':
                                            field.Data = $('input[name='+field.ID+']:checked').val();
                               
                                            break;
                            case 'object':  
                                            var index = field.ID;
                                            var sum_str = '';
                                            if(index == 'T41' || index == 'T42' || index == 'T43' || index == 'T44' || index == 'T45'){
                                                for(loop=1;loop<=10 ;loop++){
                                                    var TempID = index + '_Col' + loop;
                                                    var type = $("#"+TempID).attr("type");
                                                    var TempCheck;
                                                    switch(type){
                                                        case 'checkbox':

                                                                        if ($('#'+TempID).is(":checked"))
                                                                        {
                                                                            TempCheck = 'true';
                                                                        }
                                                                        else{
                                                                            TempCheck = 'false';
                                                                        }
                                                                        
                                                                        sum_str += '['+TempID+'|'+TempCheck+'];';
                                                                        
                                                                        break;
                                                        case 'text':
                                                                        var TempData = $('#'+TempID).val();
                                                                        sum_str += '['+TempID+'|'+TempData+'];';
                                                                        

                                                                        break;

                                                    }
                                                    
                                                }
                                                field.Data = sum_str;
                                            }
                                            else{
                                                for(loop=1;loop<=100;loop++){
                                                    var TempID = index + '_Col' + loop;
                                                    var TempData = $('#'+TempID).val();
                                                    if(!TempData){
                                                    
                                                    }
                                                    else{
                                                        sum_str += '['+TempID+'|'+TempData+'];';
                                                    }     
                                                }
                                                
                                                field.Data = sum_str;
                                            }
                                            
                                            break;
                        
                        }
                        
                    
                }
                
           

       

    }

    function SaveDraft(){

        console.table(Properties);
        
            $('#MainModal').modal('show');
            AddLoading();
            $('#TitleModal').text('Save Draft');

            // This function have method TypeDom Following text,textarea,date,label,select[people],people,check,var,radio,object
            TriggerTempData(); 
          

            var StatusCreate = CheckUpdateOrCreate(Disp_RawMatReport);
            switch(StatusCreate){   
                case 'Create':
                   
                         CreateListItem(ListData,TempCurrentData);
                            
                        break;
                case 'Update':
                        
                        UpdateListItem(ListData,TempCurrentData);
                        
                        break;
            }       
    }

    function SetPropertiesInfo(status){

        if(status == 'GetNote'){
            var Grade =  $('#GradeName').val();
            // get Color from input master
            var query = '?$select=*&$top=1&$filter=GradeName eq \''+Grade+'\'';
            var data = GetItemByRestAPI(Disp_InputMaster,query);
            if(data){
                if(data.length > 0){
                        $('#Color').val(data[0].Color);
                        //$('#Note').text(data[0].Note);
                        $("#Note").hide();
                        $("#Note").html(data[0].Note).slideDown('slow');
                        
                }  
            }
        }
        else{
            var Grade =  $('#GradeName').val();
            // get Color from input master
            var query = '?$select=*&$top=1&$filter=GradeName eq \''+Grade+'\'';
            var data = GetItemByRestAPI(Disp_InputMaster,query);
            if(data){
                if(data.length > 0){
                        $('#Color').val(data[0].Color);
                        //$('#Note').text(data[0].Note);
                        $("#Note").hide();
                        $("#Note").html(data[0].Note).slideDown('slow');
                        
                }  
            }
                
            // get info from master 
            var query = '?$select=*&$top=1&$filter=RawMat eq \''+Grade+'\'';
            var data = GetItemByRestAPI(Disp_Master_Grade,query);
            if(data){
                if(data.length > 0){
                        $('#ResourceNo').val(data[0].Resource_No);
                        $('#Package').val(data[0].Package);
                }
                    

            }
        }
        
    }

    // render table properties
    function ShowPropertiesData(action){
        if(action == 'Clear'){
            //$('#TablePQR').empty();


            // Delete list properties
            var query = '?$select=ID&$top=5000&$filter=FormID eq \''+FormID+'\'';
            var data = GetItemByRestAPI(Disp_PropertiesResult,query);
            if(data){
                if(data.length > 0){
                    for(i=0;i<data.length;i++){
                        var ItemID = data[i].ID;
                        var clientContext = new SP.ClientContext(SiteUrl);
                        var oList = clientContext.get_web().get_lists().getByTitle(Disp_PropertiesResult);
                        this.oListItem = oList.getItemById(ItemID);
                        oListItem.deleteObject();
                        clientContext.executeQueryAsync(function(){},function(){console.log('Delete properties error.');});
                    } 
                }
            }
            //////////////////////////////////////

            $('#TablePQR').fadeOut(500, function() {
                $(this).empty().show();
            });
            $('#TestResult').prop('disabled',true);

            //claer properties table
            Properties = [];
            return;
        }

        var Grade = $('#GradeName').val();
        if(Grade == '-'){
            alert('Please select Grade.');
        }
        else{
            $('#TablePQR').empty();
            
            var table_PQR = '';
            var query = '?$select=ID,Properties,Unit,Criteria_min,Criteria_max,TestMethod,Rank,PrintUnit,Alias&$top=5000&$filter=GradeName eq \''+Grade+'\' and StatusActive eq 1&$orderby=Properties asc';
            var data = GetItemByRestAPI(Disp_DataPQR,query);
            if(data){

                for(i=0;i<data.length;i++){

                        var TempObj = {
                            Title:data[i].Properties,
                            Input : {
                                id: 'Prop_Input'+i+'',
                                value: null,
                            },
                            Output :{
                                id: 'Prop_Output'+i+'',
                                value: null,
                            },
                            Result: {
                                id: 'Prop_Result'+i+'',
                                value: null,
                            },
                            Criteria: {
                                id: 'Prop_Criteria'+i+'',
                                value_min: data[i].Criteria_min, 
                                value_max: data[i].Criteria_max, 
                            },
                            Unit:{
                                id: 'Prop_Unit'+i+'',
                                value: data[i].Unit,
                            },
                            TestMethod:{
                                id: 'Prop_TestMethod'+i+'',
                                value: data[i].TestMethod,
                            }

                        };
                        Properties.push(TempObj);

                        table_PQR += '<tr style="border-style:solid; border-width:1px; border-color:lightgray;">';
                        table_PQR += '<th scope="row">'+data[i].Properties+'</th>';
                        table_PQR += '<td class="text-tr">'+data[i].Unit+'</td>';
                        table_PQR += '<td class="text-tr"><input style="text-align:center;" id="Prop_Criteria'+i+'" value="'+data[i].Criteria_min+' - '+data[i].Criteria_max+'" type="text" class="form-control form-control-sm" placeholder="" readonly></td>';
                        table_PQR += '<td class="text-tr"><input style="text-align:center;" id="Prop_Input'+i+'" type="text" class="form-control form-control-sm" placeholder="" autocomplete="off"></td>';
                        table_PQR += '<td class="text-tr"><input style="text-align:center;" id="Prop_Output'+i+'" type="text" class="form-control form-control-sm" placeholder="" readonly></td>';
                        table_PQR += '<td class="text-tr"><input style="text-align:center;" id="Prop_Result'+i+'" type="text" class="form-control form-control-sm" placeholder="" readonly></td>';
                        table_PQR += '<td class="text-tr">'+data[i].TestMethod+'</td>';
                        table_PQR += '</tr>';
                }

            //$('#TablePQR').append(table_PQR);
            //$("#TablePQR").hide();
            //$("#TablePQR").appendTo(table_PQR).slideDown('slow');
            $('#TablePQR').append(table_PQR);
            $('#TablePQR').hide();
            $('#TablePQR').show(1000);
            //$("#TablePQR").html(table_PQR).fadeIn(1000);
            //$(table_PQR).appendTo('#TablePQR').slideDown('slow');
            $('#TestResult').prop('disabled',false);
            }
        }


        // prevent press enter on keyboard
        $('input').keypress(function(event){
            var keycode = (event.keyCode ? event.keyCode : event.which);
            if(keycode == '13'){
                event.preventDefault();
                GetTestResult();
                return false;
            }
        });


        
    }


    // when click Test Result button or press enter when cursor on input in properties table
    function GetTestResult(){

        for(var i in Properties){
                var obj = Properties[i];
                var InputElemID = Properties[i]['Input'].id;
                var InputVal = $('#'+InputElemID).val();
                
                var CriteriaElemID = Properties[i]['Criteria'].id;
                var CriteriaVal_min = Properties[i]['Criteria'].value_min;
                var CriteriaVal_max = Properties[i]['Criteria'].value_max;

                var OutputElemID = Properties[i]['Output'].id;

                var ResultElemID = Properties[i]['Result'].id;
                debugger;
                if(InputVal){
                    var arr = CriteriaVal_max.split('.');
                    var CriteriaDigit = 0;
                    if(arr.length > 1 ){
                        CriteriaDigit = arr[1].length;
                    }
                    CriteriaVal_max = parseFloat(CriteriaVal_max);
                    if(CriteriaVal_min == '>=' || CriteriaVal_min == '<=' || CriteriaVal_min == '>' || CriteriaVal_min == '<'){
                        //alert(CriteriaVal_min);
                    }
                    else{
                        CriteriaVal_min = parseFloat(CriteriaVal_min);
                    }
                    var FloatInputVal = parseFloat(InputVal);
                    var FloatInputVal = FloatInputVal.toFixed(CriteriaDigit);
                    var Output;
                    var Result;


                    FloatInputVal = SetFieldColor(CriteriaVal_max , CriteriaVal_min , FloatInputVal , ResultElemID , OutputElemID);

                    $('#'+OutputElemID).val(FloatInputVal);

                    //set temp properties
                    Properties[i]['Input'].value = $('#'+Properties[i]['Input'].id).val();
                    Properties[i]['Output'].value = $('#'+Properties[i]['Output'].id).val();
                    Properties[i]['Result'].value = $('#'+Properties[i]['Result'].id).val();
            
                }
            
            
            
            }
            
            // Delete list properties
            var query = '?$select=ID&$top=5000&$filter=FormID eq \''+FormID+'\'';
            var data = GetItemByRestAPI(Disp_PropertiesResult,query);
            if(data){
                if(data.length > 0){
                    for(i=0;i<data.length;i++){
                        var ItemID = data[i].ID;
                        var clientContext = new SP.ClientContext(SiteUrl);
                        var oList = clientContext.get_web().get_lists().getByTitle(Disp_PropertiesResult);
                        this.oListItem = oList.getItemById(ItemID);
                        oListItem.deleteObject();
                        clientContext.executeQueryAsync(function(){},function(){console.log('Delete properties error.');});
                    } 
                }
            }

            
            // save to list properties
            for(i=0;i<Properties.length;i++){  
                    var clientContext = new SP.ClientContext(SiteUrl);
                    var oList = clientContext.get_web().get_lists().getByTitle(Disp_PropertiesResult);
                    var itemCreateInfo = new SP.ListItemCreationInformation();
                    this.oListItem = oList.addItem(itemCreateInfo);
                    Properties;

                    var CriteriaVal_min = Properties[i]['Criteria'].value_min;
                    var CriteriaVal_max = Properties[i]['Criteria'].value_max;
                   
                    var title = Properties[i]['Title'];
                    var input = Properties[i]['Input'].value;
                    var output = Properties[i]['Output'].value;
                    var result = Properties[i]['Result'].value;
      
                    var TestMethod = Properties[i]['TestMethod'].value;
                    var Unit = Properties[i]['Unit'].value;
                    var Criteria = Properties[i]['Criteria'].value;
                    oListItem.set_item('FormID',FormID);
                    oListItem.set_item('Properties',title);
                    oListItem.set_item('Input',input);
                    oListItem.set_item('Output',output);
                    oListItem.set_item('Result',result);
            
                    oListItem.set_item('Criteria_min',CriteriaVal_min);
                    oListItem.set_item('Criteria_max',CriteriaVal_max);
                    oListItem.set_item('Unit',Unit);
                    oListItem.set_item('TestMethod',TestMethod);
                    oListItem.set_item('Year',GetCurrentYear());
                    
                    //oListItem.set_item('StatusActive',false);
                    oListItem.update();	
                    clientContext.executeQueryAsync(function(){},function(){alert('Save Test Result Error..');});
                
                }
  
    }

    function RenderProp(){
            $('#TablePQR').empty();
            
            var table_PQR = '';
            var query = '?$select=*&$top=5000&$filter=FormID eq \''+FormID+'\'&$orderby=Properties asc';
            var data = GetItemByRestAPI(Disp_PropertiesResult,query);
            if(data){

                for(i=0;i<data.length;i++){

                        var TempObj = {
                            Title:data[i].Properties,
                            Input : {
                                id: 'Prop_Input'+i+'',
                                value: null,
                            },
                            Output :{
                                id: 'Prop_Output'+i+'',
                                value: null,
                            },
                            Result: {
                                id: 'Prop_Result'+i+'',
                                value: null,
                            },
                            Criteria: {
                                id: 'Prop_Criteria'+i+'',
                                value_min: data[i].Criteria_min, 
                                value_max: data[i].Criteria_max, 
                            },
                            Unit:{
                                id: 'Prop_Unit'+i+'',
                                value: data[i].Unit,
                            },
                            TestMethod:{
                                id: 'Prop_TestMethod'+i+'',
                                value: data[i].TestMethod,
                            }

                        };
                        Properties.push(TempObj);

                        table_PQR += '<tr style="border-style:solid; border-width:1px; border-color:lightgray;">';
                        table_PQR += '<th scope="row">'+data[i].Properties+'</th>';
                        table_PQR += '<td class="text-tr">'+data[i].Unit+'</td>';
                        table_PQR += '<td class="text-tr"><input style="text-align:center;" value="'+data[i].Criteria_min+' - '+data[i].Criteria_max+'" id="Prop_Criteria'+i+'" value="'+data[i].Criteria_min+' - '+data[i].Criteria_max+'" type="text" class="form-control form-control-sm" placeholder="" readonly></td>';
                        table_PQR += '<td class="text-tr"><input style="text-align:center;" value="'+data[i].Input+'" id="Prop_Input'+i+'" type="text" class="form-control form-control-sm" placeholder="" autocomplete="off"></td>';
                        table_PQR += '<td class="text-tr"><input style="text-align:center;" value="'+data[i].Output+'" id="Prop_Output'+i+'" type="text" class="form-control form-control-sm" placeholder="" readonly></td>';
                        table_PQR += '<td class="text-tr"><input style="text-align:center;" value="'+data[i].Result+'" id="Prop_Result'+i+'" type="text" class="form-control form-control-sm" placeholder="" readonly></td>';
                        table_PQR += '<td class="text-tr">'+data[i].TestMethod+'</td>';
                        table_PQR += '</tr>';

                       
                        
                    
                }

            //$('#TablePQR').append(table_PQR);
            //$("#TablePQR").hide();
            //$("#TablePQR").appendTo(table_PQR).slideDown('slow');
            $('#TablePQR').append(table_PQR);
            $('#TablePQR').hide();
            $('#TablePQR').show(1000);
            //$("#TablePQR").html(table_PQR).fadeIn(1000);
            //$(table_PQR).appendTo('#TablePQR').slideDown('slow');
            $('#TestResult').prop('disabled',false);

            
            // set field color
            if(data){
                
                for(i=0;i<data.length;i++){
                //  var FloatInputVal = SetFieldColor(data[i].Criteria_max , data[i].Criteria_min , data[i].Input , 'Prop_Result'+i+'' , 'Prop_Output'+i+'');
                    if(data[i].Result == 'Warning'){
                        $('#Prop_Result'+i).css('background-color','orange');
                        $('#Prop_Result'+i).css('color','white');
                        $('#Prop_Output'+i).css('color','orange');
                    }
                    else if(data[i].Result == 'Pass'){
                        $('#Prop_Result'+i).css('background-color','green');
                        $('#Prop_Result'+i).css('color','white');
                        $('#Prop_Output'+i).css('color','green');
                    }
                    else if(data[i].Result == 'Off'){
                        $('#Prop_Result'+i).css('background-color','red');
                        $('#Prop_Result'+i).css('color','white');
                        $('#Prop_Output'+i).css('color','red');
                    }
                
                }
            }

        }
    }   

    function SetFieldColor(CriteriaVal_max , CriteriaVal_min , FloatInputVal , ResultElemID , OutputElemID){
        
        if(CriteriaVal_min == '>=' || CriteriaVal_min == '<=' || CriteriaVal_min == '>' || CriteriaVal_min == '<'){
            switch(CriteriaVal_min){

                case '>=':
                        if(FloatInputVal >= CriteriaVal_max){
                            $('#'+ResultElemID).val('Pass');
                            $('#'+ResultElemID).css('background-color','green');
                            $('#'+ResultElemID).css('color','white');
                            $('#'+OutputElemID).css('color','green');
                        }else{
                            $('#'+ResultElemID).val('Off');
                            $('#'+ResultElemID).css('background-color','red');
                            $('#'+ResultElemID).css('color','white');
                            $('#'+OutputElemID).css('color','red');
                        }
                        break;

                case '<=':
                        if(FloatInputVal <= CriteriaVal_max){
                            $('#'+ResultElemID).val('Pass');
                            $('#'+ResultElemID).css('background-color','green');
                            $('#'+ResultElemID).css('color','white');
                            $('#'+OutputElemID).css('color','green');
                        }else{
                            $('#'+ResultElemID).val('Off');
                            $('#'+ResultElemID).css('background-color','red');
                            $('#'+ResultElemID).css('color','white');
                            $('#'+OutputElemID).css('color','red');
                        }
                        break;

                case '>':
                        if(FloatInputVal > CriteriaVal_max){
                            $('#'+ResultElemID).val('Pass');
                            $('#'+ResultElemID).css('background-color','green');
                            $('#'+ResultElemID).css('color','white');
                            $('#'+OutputElemID).css('color','green');
                        }else{
                            $('#'+ResultElemID).val('Off');
                            $('#'+ResultElemID).css('background-color','red');
                            $('#'+ResultElemID).css('color','white');
                            $('#'+OutputElemID).css('color','red');
                        }
                        break;

                case '<':    
                        if(FloatInputVal < CriteriaVal_max){
                            $('#'+ResultElemID).val('Pass');
                            $('#'+ResultElemID).css('background-color','green');
                            $('#'+ResultElemID).css('color','white');
                            $('#'+OutputElemID).css('color','green');
                        }else{
                            $('#'+ResultElemID).val('Off');
                            $('#'+ResultElemID).css('background-color','red');
                            $('#'+ResultElemID).css('color','white');
                            $('#'+OutputElemID).css('color','red');
                        }
                        break;                   
            }

            return FloatInputVal;
        }
        else{
            if(CriteriaVal_max < FloatInputVal || FloatInputVal < CriteriaVal_min){
                $('#'+ResultElemID).val('Off');
                $('#'+ResultElemID).css('background-color','red');
                $('#'+ResultElemID).css('color','white');
                $('#'+OutputElemID).css('color','red');


            }
            else{
                
                $('#'+ResultElemID).val('Error');
                $('#'+ResultElemID).css('background-color','white');
                $('#'+ResultElemID).css('color','red');
                $('#'+OutputElemID).css('color','red');
        
                $('#'+ResultElemID).val('Pass');
                $('#'+ResultElemID).css('background-color','green');
                $('#'+ResultElemID).css('color','white');
                $('#'+OutputElemID).css('color','green');

                // cal 10 % Error
                var NumInit = CriteriaVal_max - CriteriaVal_min;
                var Err_unit = (NumInit * 10)/100;
                var NewMax = CriteriaVal_max - Err_unit;
                var NewMin = CriteriaVal_min + Err_unit;

                if(FloatInputVal >= NewMax && FloatInputVal <= CriteriaVal_max){
                    $('#'+ResultElemID).val('Warning');
                    $('#'+ResultElemID).css('background-color','orange');
                    $('#'+ResultElemID).css('color','white');
                    $('#'+OutputElemID).css('color','orange');
                }
                else if(FloatInputVal >= CriteriaVal_min && FloatInputVal <= NewMin){
                    $('#'+ResultElemID).val('Warning');
                    $('#'+ResultElemID).css('background-color','orange');
                    $('#'+ResultElemID).css('color','white');
                    $('#'+OutputElemID).css('color','orange');
                }
                else if(isNaN(FloatInputVal) == true)
                {
                    $('#'+ResultElemID).val('Error');
                    $('#'+ResultElemID).css('background-color','white');
                    $('#'+ResultElemID).css('color','red');

                    $('#'+OutputElemID).css('color','red');
                    $('#'+OutputElemID).css('background-color','white');
                    FloatInputVal = 'Error';
                }   
            }
            return FloatInputVal;
        }

        

        
    }

    function CalSpeedTime(){
        //Calculate Speed time when ReportDate & TestDate have value
        // ReportDate - TestDate = Spped time
            
        var ReportDate = $('#ReportDate').val();
        var TestDate = $('#TestDate').val();
        
       
        
        if(ReportDate && TestDate){
           
            ReportDate = SetTime(ReportDate);
            TestDate = SetTime(TestDate);
            ReportDate = new Date(ReportDate);
            TestDate = new Date(TestDate);
            
            //alert(ReportDate + '&' + TestDate);


            // get total seconds between the times
            var delta = Math.abs(ReportDate - TestDate) / 1000;

            // calculate (and subtract) whole days
            var days = Math.floor(delta / 86400);
            delta -= days * 86400;

            // calculate (and subtract) whole hours
            var hours = Math.floor(delta / 3600) % 24;
            delta -= hours * 3600;

            // calculate (and subtract) whole minutes
            var minutes = Math.floor(delta / 60) % 60;
            delta -= minutes * 60;

            // what's left is seconds
            var seconds = delta % 60;  // in theory the modulus is not required

            $('#ST_Day').text(days);
            $('#ST_Hour').text(hours);
            $('#ST_Minute').text(minutes);
            //alert(days + ' days ' + hours + ' hours ' + minutes + ' minutes ' + seconds + ' seconds');

            

        }
            
        ///////////////////////////////////

        function SetFormatTime(day){
            var today = new Date(day);
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!
            var yyyy = today.getFullYear();
            var hour = today.getHours();
            var min = today.getMinutes();
            var sec = today.getSeconds();

            if(dd<10) {
                dd = '0'+dd;
            } 

            if(mm<10) {
                mm = '0'+mm;
            } 
            if(min<10){
                min = '0'+min;

            }
            
            //today = mm + '/' + dd + '/' + yyyy + '; ' + hour + ":" + min + ":" + sec;
            today = dd + '/' + mm + '/' + yyyy + ', ' + hour + ":" + min;
            

            return today;
        }
    }
</script>

